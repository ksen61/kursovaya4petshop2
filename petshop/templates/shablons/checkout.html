{% extends "base.html" %}
{% load static %}

{% block title %}Оформление заказа | Yes of Кусь{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'style/create.css' %}" type="text/css">

<style>
.form-error { color: red; font-size: 14px; margin-top: 5px; }
</style>
{% endblock %}

{% block content %}
<div id="checkout-container" data-create-order-url="{% url 'api-create-order' %}"></div>

<div class="checkout-container">
    <div class="checkout-header">
        <h1><i class="fas fa-shopping-bag"></i> Оформление заказа</h1>
        <div class="checkout-steps">
            <span class="step active">1. Корзина</span>
            <span class="step active">2. Оформление</span>
            <span class="step">3. Подтверждение</span>
        </div>
    </div>

    <div class="checkout-grid">
        <div class="order-summary">
            <div class="summary-header">
                <h2><i class="fas fa-list-ol"></i> Ваш заказ</h2>
            </div>
            <ul class="order-items" id="order-items"></ul>
            <div class="order-totals">
                <div class="total-row">
                    <span>Итого:</span>
                    <span class="total-price" id="total-price">0 ₽</span>
                </div>
            </div>
        </div>

        <div class="order-form-container">
            <form id="order-form" class="order-form" novalidate>
                {% csrf_token %}
                
                <h2><i class="fas fa-user-circle"></i> Контактные данные</h2>
            
                <div class="form-group">
                    <label for="first_name">Имя*</label>
                    <input type="text" name="first_name" id="first_name">
                    <div class="form-error" id="error-first_name"></div>
                </div>
            
                <div class="form-group">
                    <label for="last_name">Фамилия*</label>
                    <input type="text" name="last_name" id="last_name">
                    <div class="form-error" id="error-last_name"></div>
                </div>
            
                <div class="form-group">
                    <label for="email">Email*</label>
                    <input type="email" name="email" id="email">
                    <div class="form-error" id="error-email"></div>
                </div>
            
                <div class="form-group">
                    <label for="phone">Телефон*</label>
                    <input type="text" name="phone" id="phone">
                    <div class="form-error" id="error-phone"></div>
                </div>
            
                <h2><i class="fas fa-truck"></i> Пункты выдачи</h2>
                <div class="form-group">
                    <label for="pickup_point">Выберите пункт выдачи*</label>
                    <select name="pickup_point" id="pickup_point"></select>
                    <div class="form-error" id="error-pickup_point"></div>
                </div>
            
                <div class="form-actions">
                    <button type="submit" class="submit-order">
                        <i class="fas fa-check-circle"></i> Подтвердить заказ
                    </button>
                    <a href="{% url 'cart' %}" class="back-link">
                        <i class="fas fa-arrow-left"></i> Вернуться в корзину
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{{ block.super }}
<script src="{% static 'js/checkout.js' %}" defer></script>
{% endblock %}